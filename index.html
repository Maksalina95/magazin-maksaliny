<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ú–∞–≥–∞–∑–∏–Ω –ú–∞–∫—Å–∞–ª–∏–Ω—ã</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <header>
    <h1>–ú–∞–≥–∞–∑–∏–Ω –ú–∞–∫—Å–∞–ª–∏–Ω—ã</h1>
    <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." />
  </header>

  <main id="product-list"></main>

  <footer>
    <p>&copy; 2025 –ú–∞–≥–∞–∑–∏–Ω –ú–∞–∫—Å–∞–ª–∏–Ω—ã</p>
  </footer>

  <script src="app.js"></script>

  <!-- üîß –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', reg))
          .catch(err => console.log('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', err));
      });
    }
  </script>

  <!-- üí° –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" -->
  <script>
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –±–∞–Ω–Ω–µ—Ä
      deferredPrompt = e;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É (–º–æ–∂–µ—à—å –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å)
      const installBtn = document.createElement('button');
      installBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ú–∞–≥–∞–∑–∏–Ω –ú–∞–∫—Å–∞–ª–∏–Ω—ã';
      installBtn.style.position = 'fixed';
      installBtn.style.bottom = '20px';
      installBtn.style.left = '20px';
      installBtn.style.padding = '10px 15px';
      installBtn.style.background = '#4CAF50';
      installBtn.style.color = 'white';
      installBtn.style.border = 'none';
      installBtn.style.borderRadius = '10px';
      installBtn.style.zIndex = '9999';
      installBtn.style.cursor = 'pointer';
      document.body.appendChild(installBtn);

      installBtn.addEventListener('click', () => {
        installBtn.remove(); // –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫—É
        deferredPrompt.prompt(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä
        deferredPrompt.userChoice.then(choiceResult => {
          if (choiceResult.outcome === 'accepted') {
            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∏–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ');
          } else {
            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏');
          }
          deferredPrompt = null;
        });
      });
    });
  </script>
</body>
</html>